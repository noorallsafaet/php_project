!function(a,b,c){"use strict";var d={VERSION:"1.1.0",inprocess:0,winWidth:0,winHeight:0,mainMenu:{virtualtour:{id:"virtualtour",isActive:!0,templateUrl:"templates/virtualtour.html",refresh:function(a){a.virtualTourManager.fn.itemsRefresh(a)}},filemanager:{id:"filemanager",isActive:!1,templateUrl:"templates/filemanager.html",refresh:function(a){a.fileManager.fn.itemsRefresh(a)}}},fileManager:{items:[],itemsTotal:0,itemsPerPage:50,page:0,pages:[],selectedAll:!1,path:[],rootUrl:"",clipboard:{operation:null,items:[]},fn:{itemsInit:function(a){a.fileManager.fn.itemsRefresh(a)},itemsRefresh:function(a){var b=a.fileManager.fn.getCurrentPath(a),c=a.fileManager.page;a.fileManager.fn.getItems(a,c,b)},selectAll:function(a,b){for(var c=0,d=a.fileManager.items.length;d>c;++c)a.fileManager.items[c].selected=b},selectRow:function(a,b){b.selected=!b.selected},isSelected:function(a){for(var b=0,c=a.fileManager.items.length;c>b;++b)if(a.fileManager.items[b].selected)return!0;return!1},isSelectedAll:function(a){for(var b=0,c=a.fileManager.items.length;c>b;++b)if(!a.fileManager.items[b].selected)return!1;return a.fileManager.items.length>0?!0:!1},getSelectedItems:function(a){for(var b=[],c=a.fileManager.fn.getCurrentPath(a),d=0,e=a.fileManager.items.length;e>d;++d)if(a.fileManager.items[d].selected){var f={id:a.fileManager.items[d].id,type:a.fileManager.items[d].type,name:a.fileManager.items[d].name,path:c};b.push(f)}return b},getItems:function(a,c,d){var e={action:"list",page:c,itemsPerPage:a.fileManager.itemsPerPage,path:d};a.inprocess++,a.service.$http.post("filemanager",e).success(function(c,d){var e=[];if(c.items)for(var f=0,g=c.items.length;g>f;++f){var h=b.merge({},c.items[f]);h.selected=!1,h.created_at=a.fn.parseDate(h.created_at),h.updated_at=a.fn.parseDate(h.updated_at),e.push(h)}for(var i=Math.ceil(c.total/c.itemsPerPage),j=new Array(i),f=0;i>f;f++)j[f]=f+1;a.fileManager.items=e,a.fileManager.itemsTotal=c.total,a.fileManager.page=c.page,a.fileManager.path=c.path,a.fileManager.pages=j}).error(function(b,c){a.service.growl.error("The list operation failed"),console.log("Error %s - response error, please check the ajax response.".replace("%s",c))})["finally"](function(){a.inprocess--})},getFolderItems:function(a,b){var c=a.fileManager.fn.getCurrentPath(a);c=c+(""==c?"":"/")+b.name,a.fileManager.fn.getItems(a,0,c)},getFolderItemsBreadcrumb:function(a,b){a.fileManager.fn.getItems(a,0,b.path)},getPrevPage:function(a){var b=a.fileManager.page-1;if(!(0>b)){var c=a.fileManager.fn.getCurrentPath(a);a.fileManager.fn.getItems(a,b,c)}},getNextPage:function(a){var b=a.fileManager.page+1;if(!(b>=a.fileManager.pages.length)){var c=a.fileManager.fn.getCurrentPath(a);a.fileManager.fn.getItems(a,b,c)}},getPage:function(a,b){var c=a.fileManager.fn.getCurrentPath(a);a.fileManager.fn.getItems(a,b,c)},getCurrentPath:function(a){for(var b="",c=1,d=a.fileManager.path.length;d>c;++c)b+=a.fileManager.path[c].name+(c+1==d?"":"/");return b},removeItemsConfirm:function(a){if(!a.fileManager.fn.isSelected(a))return void a.service.growl.warning("You should select items to delete");var b={content:"Are you sure to delete selected items?"};a.modal.fn.show(a,"templates/modal-confirm.html",b).then(function(c){a.modal.fn.close(a,b.id),"close"!=c&&c&&a.fileManager.fn.removeItems(a)})},removeItems:function(a){var b=a.fileManager.fn.getCurrentPath(a),c=a.fileManager.fn.getSelectedItems(a),d=c.length,e={action:"delete",items:c,path:b};a.inprocess++,a.service.$http.post("filemanager",e).success(function(b,c){b.processed&&b.processed.length==d?a.service.growl.success("The delete operation successful"):(a.service.growl.warning("Not all selected items are deleted"),console.log(b.error)),a.fileManager.fn.itemsRefresh(a)}).error(function(b,c){a.service.growl.error("The delete operation failed"),console.log("Error %s - response error, please check the ajax response.".replace("%s",c))})["finally"](function(){a.inprocess--})},createFolderConfirm:function(a){var b={folderName:null};a.modal.fn.show(a,"templates/modal-create-folder.html",b).then(function(c){a.modal.fn.close(a,b.id),"close"!=c&&c&&a.fileManager.fn.createFolder(a,b.folderName)})},createFolder:function(a,c){var d=a.fileManager.fn.getCurrentPath(a),e={action:"mkdir",name:c,path:d};a.inprocess++,a.service.$http.post("filemanager",e).success(function(c,d){if(c.result&&c.item){a.service.growl.success("The create folder operation successful");var e=b.merge({},c.item);e.selected=!1,e.size=e.size,e.created_at=a.fn.parseDate(e.created_at),e.updated_at=a.fn.parseDate(e.updated_at),a.fileManager.items.push(e),a.fileManager.itemsTotal++}else a.service.growl.error("The create folder operation failed"),console.log(c.error)}).error(function(b,c){a.service.growl.error("The create folder operation failed"),console.log("Error %s - response error, please check the ajax response.".replace("%s",c))})["finally"](function(){a.inprocess--})},uploadFileConfirm:function(a){var b="/"+a.fileManager.fn.getCurrentPath(a),c={inprocess:0,path:b,files:[],fn:{select:function(a,b){a.files=b},close:function(a){for(var b=a.files.length;b--;)a.fn.remove(a,b);a.deferred.resolve("close")},remove:function(a,b){var c=a.files[b];c&&c.xhr&&4!=c.xhr.readyState&&c.xhr.abort(),a.files.splice(b,1)},upload:function(a){for(var b=a.appData.fileManager.fn.getCurrentPath(a.appData),c=0;c<a.files.length;++c){var d=a.files[c];d.error=!1,d.progress=0,function(c){var d={action:"upload",file:c,path:b};a.inprocess++,a.appData.service.upload.upload({url:"filemanager",data:d}).progress(function(a){c.progress=Math.min(100,parseInt(100*a.loaded/a.total))-1}).success(function(a,b){"boolean"==typeof a.result&&a.result||(c.error=!0)}).error(function(a,b){c.error=!0,console.log("Error %s - response error, please check the ajax response.".replace("%s",b))}).xhr(function(a){c.xhr=a})["finally"](function(){a.inprocess--,setTimeout(function(){c.error?(c.progress=0,console.log("Response error, please check the ajax response.")):c.progress=100,a.appData.service.$root.safeApply()},1+100*a.inprocess)})}(d)}}}};a.modal.fn.show(a,"templates/modal-upload-file.html",c).then(function(b){return a.modal.fn.close(a,c.id),"close"==b?void a.fileManager.fn.itemsRefresh(c.appData):void 0})},editItemOpen:function(a,b){b.tmpname=b.name,b.edit=!0},renameItem:function(a,b){var c=a.fileManager.fn.getCurrentPath(a),d={action:"rename",oldname:b.name,newname:b.tmpname,path:c};a.inprocess++,a.service.$http.post("filemanager",d).success(function(c,d){c.result?(b.tmpname=null,b.edit=!1,b.name=c.name,a.service.growl.success("The rename operation successful")):(a.service.growl.error("The rename operation failed"),console.log(c.error))}).error(function(b,c){a.service.growl.error("The rename operation failed"),console.log("Error %s - response error, please check the ajax response.".replace("%s",c))})["finally"](function(){a.inprocess--})},editItemClose:function(a,b){b.tmpname=null,b.edit=!1},cutItems:function(a){var b=a.fileManager.fn.getSelectedItems(a);b.length>0&&(a.fileManager.clipboard.operation="cut",a.fileManager.clipboard.items=b)},copyItems:function(a){var b=a.fileManager.fn.getSelectedItems(a);b.length>0&&(a.fileManager.clipboard.operation="copy",a.fileManager.clipboard.items=b)},pasteItemsConfirm:function(a){var b={content:"Are you sure to "+a.fileManager.clipboard.operation+" items?"};a.modal.fn.show(a,"templates/modal-confirm.html",b).then(function(c){a.modal.fn.close(a,b.id),"close"!=c&&c&&a.fileManager.fn.pasteItems(a)})},pasteItems:function(a){var b=a.fileManager.fn.getCurrentPath(a),c=a.fileManager.clipboard.items,d=c.length,e=a.fileManager.clipboard.operation,f={action:"paste",items:c,operation:e,path:b};a.inprocess++,a.service.$http.post("filemanager",f).success(function(b,c){b.processed&&b.processed.length==d?a.service.growl.success("The paste operation successful"):(a.service.growl.warning("Not all items are processed"),console.log(b.error)),"cut"==f.operation&&(a.fileManager.clipboard.operation=null,a.fileManager.clipboard.items=[]),a.fileManager.fn.itemsRefresh(a)}).error(function(b,c){a.service.growl.error("The paste operation failed"),console.log("Error %s - response error, please check the ajax response.".replace("%s",c))})["finally"](function(){a.inprocess--})}}},virtualTourManager:{items:[],itemsTotal:0,itemsPerPage:50,page:0,pages:[],selectedAll:!1,order:"created_desc",clipboard:{operation:null,items:[]},builder:{dragged:null,panoramaConfigTemplates:{virtualTour:{type:"VirtualTour",title:null,scenes:[]},scene:{title:null,yaw:null,pitch:null,zoom:null,image:{isCustom:!1,url:null},imageThumb:{isCustom:!1,url:null}}},panoramaConfig:{},fn:{getPanoramaConfig:function(a,c){var d=a.service.$q.defer();if(a.virtualTourManager.builder.fn.resetPanoramaConfig(a),null==c){var e=a.virtualTourManager.builder.panoramaConfig;return d.resolve(e),d.promise}var f={action:"get",name:c};return a.inprocess++,a.service.$http.post("virtualtourmanager",f).success(function(c,e){if(c.result){for(var f=b.merge({},a.virtualTourManager.builder.panoramaConfigTemplates.virtualTour,c.config),g=0;g<f.scenes.length;g++){var h=b.merge({},a.virtualTourManager.builder.panoramaConfigTemplates.scene,f.scenes[g]);f.scenes[g]=h}a.virtualTourManager.builder.panoramaConfig=f,d.resolve(f)}else a.service.growl.error(c.error)}).error(function(b,c){a.service.growl.error("Error %s - response error, please check the ajax response.".replace("%s",c))})["finally"](function(){a.inprocess--}),d.promise},resetPanoramaConfig:function(a){a.virtualTourManager.builder.panoramaConfig=b.merge({},a.virtualTourManager.builder.panoramaConfigTemplates.virtualTour)},isSelected:function(a){for(var b=0,c=a.virtualTourManager.builder.panoramaConfig.scenes.length;c>b;++b)if(a.virtualTourManager.builder.panoramaConfig.scenes[b].selected)return!0;return!1},getSelectedItems:function(a){for(var c=[],d=0,e=a.virtualTourManager.builder.panoramaConfig.scenes.length;e>d;++d){var f=a.virtualTourManager.builder.panoramaConfig.scenes[d];if(f.selected){var g=b.copy(f);c.push(g)}}return c},removeItemsConfirm:function(a){var b={content:"Are you sure to delete selected items?"};a.modal.fn.show(a,"templates/modal-confirm.html",b).then(function(c){a.modal.fn.close(a,b.id),"close"!=c&&c&&a.virtualTourManager.builder.fn.removeItems(a)})},removeItems:function(a){for(var b=a.virtualTourManager.builder.panoramaConfig.scenes.length;b--;){var c=a.virtualTourManager.builder.panoramaConfig.scenes[b];c.selected&&a.virtualTourManager.builder.panoramaConfig.scenes.splice(b,1)}},setUrlConfirm:function(a,b){var c={url:b.url};a.modal.fn.show(a,"templates/modal-set-url.html",c).then(function(d){a.modal.fn.close(a,c.id),"close"!=d&&d&&a.virtualTourManager.builder.fn.setUrl(a,b,c.url,!0)})},setUrl:function(a,b,c,d){c!=b.url&&(b.url=c,b.isCustom=d)},getImageUrl:function(a,b){if(b){var c="";return b.isCustom?c=b.url:b.url&&b.url.length>0&&(c=a.fileManager.rootUrl+"/"+b.url),c}},selectImageConfirm:function(a,b){var c={multiSelect:!1};a.modal.fn.show(a,"templates/modal-filemanager.html",c).then(function(d){if(a.modal.fn.close(a,c.id),"close"!=d&&"boolean"!=typeof d){var e=d,f=a.fileManager.fn.getCurrentPath(a),f=f+(""==f?"":"/")+e.name;a.virtualTourManager.builder.fn.setUrl(a,b,f,!1)}})},addItemsConfirm:function(a){var b={multiSelect:!0};a.modal.fn.show(a,"templates/modal-filemanager.html",b).then(function(c){if(a.modal.fn.close(a,b.id),"close"!=c){"boolean"!=typeof c&&(a.fileManager.fn.selectAll(a,!1),c.selected=!0);var d=a.fileManager.fn.getSelectedItems(a);a.virtualTourManager.builder.fn.addItems(a,d)}})},addItems:function(a,c){for(var d=0,e=c.length;e>d;++d){var f=c[d];if("folder"!=f.type){var g=a.fileManager.fn.getCurrentPath(a),g=g+(""==g?"":"/")+f.name,h=b.copy(a.virtualTourManager.builder.panoramaConfigTemplates.scene);a.virtualTourManager.builder.fn.setUrl(a,h.image,g,!1),a.virtualTourManager.builder.panoramaConfig.scenes.push(h)}}}}},fn:{itemsInit:function(a){a.virtualTourManager.fn.itemsRefresh(a)},itemsRefresh:function(a){var b=a.virtualTourManager.page;a.virtualTourManager.fn.getItems(a,b)},setOrder:function(a,b){var c=a.virtualTourManager.order;"title"==b&&(c="title_asc"==c?"title_desc":"title_asc"),"created"==b&&(c="created_asc"==c?"created_desc":"created_asc"),"updated"==b&&(c="updated_asc"==c?"updated_desc":"updated_asc"),a.virtualTourManager.order=c,a.virtualTourManager.fn.itemsRefresh(a)},selectAll:function(a){for(var b=0,c=a.virtualTourManager.items.length;c>b;++b)a.virtualTourManager.items[b].selected=a.virtualTourManager.selectedAll},selectRow:function(a,b){b.selected=!b.selected},isSelected:function(a){for(var b=0,c=a.virtualTourManager.items.length;c>b;++b)if(a.virtualTourManager.items[b].selected)return!0;return!1},isSelectedAll:function(a){for(var b=0,c=a.virtualTourManager.items.length;c>b;++b)if(!a.virtualTourManager.items[b].selected)return!1;return a.virtualTourManager.items.length>0?!0:!1},getSelectedItems:function(a){for(var b=[],c=0,d=a.virtualTourManager.items.length;d>c;++c)if(a.virtualTourManager.items[c].selected){var e={id:a.virtualTourManager.items[c].id,name:a.virtualTourManager.items[c].name};b.push(e)}return b},getItems:function(a,c){var d={action:"list",page:c,order:a.virtualTourManager.order,itemsPerPage:a.virtualTourManager.itemsPerPage};a.inprocess++,a.service.$http.post("virtualtourmanager",d).success(function(c,d){var e=[];if(c.items)for(var f=0,g=c.items.length;g>f;++f){var h=b.merge({},c.items[f]);h.selected=!1,h.created_at=a.fn.parseDate(h.created_at),h.updated_at=a.fn.parseDate(h.updated_at),e.push(h)}for(var i=Math.ceil(c.total/c.itemsPerPage),j=new Array(i),f=0;i>f;f++)j[f]=f+1;a.virtualTourManager.items=e,a.virtualTourManager.itemsTotal=c.total,a.virtualTourManager.page=c.page,a.virtualTourManager.pages=j}).error(function(b,c){a.service.growl.error("Error %s - response error, please check the ajax response.".replace("%s",c))})["finally"](function(){a.inprocess--})},getPrevPage:function(a){var b=a.virtualTourManager.page-1;0>b||a.virtualTourManager.fn.getItems(a,b)},getNextPage:function(a){var b=a.virtualTourManager.page+1;b>=a.virtualTourManager.pages.length||a.virtualTourManager.fn.getItems(a,b)},getPage:function(a,b){a.virtualTourManager.fn.getItems(a,b)},createVirtualTourConfirm:function(a){a.virtualTourManager.fn.updateVirtualTourConfirm(a,null)},updateVirtualTourConfirm:function(a,b){a.virtualTourManager.builder.fn.getPanoramaConfig(a,b).then(function(c){var d={isNewItem:b?!1:!0,name:b,panoramaConfig:c};a.modal.fn.show(a,"templates/modal-update-virtualtour.html",d).then(function(b){a.modal.fn.close(a,d.id),"close"!=b&&b&&a.virtualTourManager.fn.updateVirtualTour(a,d.name,d.panoramaConfig)})})},updateVirtualTour:function(a,b,c){var d={action:"update",name:b,config:c};a.inprocess++,a.service.$http.post("virtualtourmanager",d).success(function(b,c){b.result?(a.virtualTourManager.fn.itemsRefresh(a),a.service.growl.success("The update operation successful")):a.service.growl.error(b.error)}).error(function(b,c){a.service.growl.error("Error %s - response error, please check the ajax response.".replace("%s",c))})["finally"](function(){a.inprocess--})},removeItemsConfirm:function(a){if(!a.virtualTourManager.fn.isSelected(a))return void a.service.growl.warning("You should select items to delete");var b={content:"Are you sure to delete selected items?"};a.modal.fn.show(a,"templates/modal-confirm.html",b).then(function(c){a.modal.fn.close(a,b.id),"close"!=c&&c&&a.virtualTourManager.fn.removeItems(a)})},removeItems:function(a){var b=a.virtualTourManager.fn.getSelectedItems(a),c=b.length,d={action:"delete",items:b};a.inprocess++,a.service.$http.post("virtualtourmanager",d).success(function(b,d){b.processed&&b.processed.length==c?a.service.growl.success("The delete operation successful"):(a.service.growl.warning("Not all selected items are deleted"),console.log(b.error)),a.virtualTourManager.fn.itemsRefresh(a)}).error(function(b,c){a.service.growl.error("Error %s - response error, please check the ajax response.".replace("%s",c))})["finally"](function(){a.inprocess--})},editItemOpen:function(a,b){b.tmptitle=b.title,b.edit=!0},renameItem:function(a,b){var c={action:"rename",name:b.name,oldtitle:b.title,newtitle:b.tmptitle};a.inprocess++,a.service.$http.post("virtualtourmanager",c).success(function(c,d){c.result?(b.tmptitle=null,b.edit=!1,b.title=c.title,a.service.growl.success("The rename operation successful")):a.service.growl.error(c.error)}).error(function(b,c){a.service.growl.error("Error %s - response error, please check the ajax response.".replace("%s",c))})["finally"](function(){a.inprocess--})},editItemClose:function(a,b){b.tmptitle=null,b.edit=!1}}},modal:{count:0,items:[],fn:{show:function(a,c,d,e){var f=++a.modal.count,g=a.service.$q.defer();return a.modal.items.push(f),a.inprocess++,a.service.$templateRequest(c).then(function(c){var e=b.element(c);jQuery("body").addClass("fstpn-ui-modal-open"),(void 0==d.easyClose||d.easyClose)&&e.on("click",function(a){h.modalData.deferred.resolve("close")}),e.find(".fstpn-ui-modal-dialog").on("click",function(a){return a.preventDefault(),!1}),e.on("click",function(b){a.modal.fn.close(a,f)}),e.addClass("fstpn-ui-modal-hidden"),jQuery(".fstpn-ui-modals").append(e);var h=a.service.$root.$new(!0);h.modalData=d,h.modalData.id=f,h.modalData.deferred=g,h.modalData.appData=a,a.service.$compile(e)(h),setTimeout(function(){e.removeClass("fstpn-ui-modal-hidden")},1)})["finally"](function(){e&&"function"==typeof e&&e.call(this),a.inprocess--}),g.promise},close:function(a,b){jQuery("#fstpn-ui-modal-"+b).remove();var c=a.modal.items.indexOf(b);a.modal.items.splice(c,1),0==a.modal.items.length&&jQuery("body").removeClass("fstpn-ui-modal-open")}}},fn:{init:function(b){b.fn.initRootUrl(b),jQuery(a).on("resize",jQuery.proxy(function(){this.fn.resize(this)},b)),b.fn.resize(b)},initRootUrl:function(a){var b={action:"rooturl"};a.inprocess++,a.service.$http.post("filemanager",b).success(function(b,c){b.rootUrl&&(a.fileManager.rootUrl=b.rootUrl)}).error(function(b,c){a.service.growl.error("Error %s - response error, please check the ajax response.".replace("%s",c))})["finally"](function(){a.inprocess--})},resize:function(b){var c=jQuery(a);b.winWidth=c.outerWidth(),b.winHeight=c.outerHeight(),b.service.$root.safeApply()},mainMenuItemInit:function(a,b){jQuery("#fstpn-ui-block-menu-item-"+b).on("click",function(c){c.preventDefault(),a.fn.mainMenuItemClick(a,b)}),a.mainMenu[b].isActive&&(a.fn.workspaceInit(a,b),a.service.$root.safeApply())},mainMenuItemClick:function(a,b){a.mainMenu[b].isActive||(a.fn.workspaceInit(a,b),a.fn.mainMenuReset(a),a.mainMenu[b].isActive=!0,a.service.$root.safeApply())},mainMenuReset:function(a){var b=a.mainMenu;for(var c in b)b.hasOwnProperty(c)&&(b[c].isActive=!1)},refreshWorkspace:function(a){var b=a.mainMenu;for(var c in b)b.hasOwnProperty(c)&&b[c].isActive&&b[c].refresh(a)},workspaceInit:function(a,c){var d=a.mainMenu[c].templateUrl;a.inprocess++,a.service.$templateRequest(d).then(function(c){var d=b.element(c);jQuery("#fstpn-ui-workspace").empty().append(d);var e=a.service.$root.$new(!0);e.appData=a,a.service.$compile(d)(e)})["finally"](function(){a.inprocess--})},parseDate:function(a){var b=(a||"").toString().split(/[- :]/);return new Date(b[0],b[1]-1,b[2],b[3],b[4],b[5])},isLightBox:function(a){return null!=a.match(/\.(jpeg|jpg|gif|png)$/)}},service:{$compile:null,$timeout:null,$templateRequest:null,$http:null,$q:null,growl:null,upload:null,$root:null}};a.fastpanoAppData=d,b.module("ngFastPanoApp",["ngFastPanoApp.services","ngFastPanoApp.controllers","ngFastPanoApp.directives","ngFastPanoApp.filters","angular-growl","ngAnimate","ngFileUpload","as.sortable"]).config(["growlProvider",function(a){a.globalTimeToLive(9e3),a.globalDisableCloseButton(!1),a.onlyUniqueMessages(!1)}]).run(["$rootScope",function(a){a.safeApply=function(a){var b=this.$root.$$phase;return"$apply"!==b&&"$digest"!==b?void this.$apply(a):void(a&&"function"==typeof a&&a())}}]),b.module("ngFastPanoApp.services",[]).factory("appData",function(){return d}),b.module("ngFastPanoApp.controllers",[]).controller("ngFastPanoAppController",["$scope","$compile","$timeout","$templateRequest","$http","$q","growl","Upload","appData",function(a,b,c,d,e,f,g,h,i){i.service.$compile=b,i.service.$timeout=c,i.service.$templateRequest=d,i.service.$http=e,i.service.$q=f,i.service.growl=g,i.service.upload=h,i.service.$root=a.$root,a.appData=i}]),b.module("ngFastPanoApp.directives",[]).directive("checkbox",function(){function a(a,b,c,d){function e(){a.$evalAsync(f)}function f(){d.$viewValue?b.addClass("fstpn-ui-checked"):b.removeClass("fstpn-ui-checked")}function g(b){a.$apply(function(){d.$setViewValue(!d.$viewValue),f()})}b.on("click",g),d.$render=e}return{restrict:"EA",require:"ngModel",replace:!0,template:'<div class="fstpn-ui-checkbox">&nbsp;</div>',scope:{ngModel:"="},link:a}}).directive("radio",["$parse","$document",function(a,c){function d(c,d,e,f){function g(){c.$evalAsync(h)}function h(){var a=k(f.$viewValue);l.list.removeClass("fstpn-ui-selected"),a&&a.addClass("fstpn-ui-selected")}function i(a){c.$apply(function(){var c=b.element(a.target);f.$setViewValue(j(c)),h()})}function j(b){var c=a(b.attr("value")||b.attr("x-value")||"null");return c(b.scope())}function k(a){for(var c=l.list,d=0,e=c.length;e>d;d++){var f=b.element(c[d]);if(j(f)===a)return f}return null}var l={element:d,list:d.parent().find(".fstpn-ui-radio")};d.on("click",i),f.$render=g}return{restrict:"EA",require:"ngModel",replace:!0,template:'<div class="fstpn-ui-radio">&nbsp;</div>',scope:{ngModel:"=",ngValue:"@"},link:d}}]).directive("dropdown",["$compile",function(a){function b(b,c){function d(a){e(a)}b.prepend('<div class="fstpn-ui-dropdown-display"><span></span></div>'),b.addClass("fstpn-ui-dropdown"),b.find(".fstpn-ui-dropdown-list > div").addClass("fstpn-ui-dropdown-item");var e=a(b,null,2);return d}return{compile:b,priority:2,restrict:"A",terminal:!0}}]).directive("dropdown",["$parse","$document",function(a,c){function d(d,e,f,g){function h(a){l()?m():n()}function i(a){d.$apply(function(){m();var c=b.element(a.target);g.$setViewValue(o(c)),q()})}function j(a){var c=b.element(a.target);l()&&!c.closest(s.root).length&&m()}function k(){c.off("mousedown",j)}function l(){return s.root.hasClass("fstpn-ui-dropdown-list-open")}function m(){s.root.removeClass("fstpn-ui-dropdown-list-open")}function n(){s.root.addClass("fstpn-ui-dropdown-list-open")}function o(b){var c=a(b.attr("value")||b.attr("x-value")||"null");return c(b.scope())}function p(){d.$evalAsync(q)}function q(){var a=r(g.$viewValue);s.list.find(".fstpn-ui-dropdown-item").removeClass("fstpn-ui-selected"),a?(s.display.removeClass("fstpn-ui-dropdown-placeholder").find("span").html(a.html()),a.addClass("fstpn-ui-selected")):s.display.addClass("fstpn-ui-dropdown-placeholder").find("span").html(t)}function r(a){for(var c=s.list.children(".fstpn-ui-dropdown-item"),d=0,e=c.length;e>d;d++){var f=b.element(c[d]);if(o(f)===a)return f}return null}e.addClass("fstpn-ui-dropdown"),e.find(".fstpn-ui-dropdown-list > div").addClass("fstpn-ui-dropdown-item");var s={root:e,display:e.find(".fstpn-ui-dropdown-display"),list:e.find(".fstpn-ui-dropdown-list")},t=f.placeholder||"&nbsp;";s.display.on("click",h),s.list.on("click",".fstpn-ui-dropdown-item",i),c.on("mousedown",j),d.$on("$destroy",k),g.$render=p}return{restrict:"EA",require:"ngModel",scope:{ngModel:"="},link:d}}]).directive("pressEnter",function(){return function(a,b,c){b.bind("keydown keypress",function(b){13===b.which&&(a.$apply(function(){a.$eval(c.pressEnter)}),b.preventDefault())})}}).directive("pressEsc",function(){return function(a,b,c){b.bind("keydown keypress",function(b){27===b.which&&(a.$apply(function(){a.$eval(c.pressEsc)}),b.preventDefault())})}}).directive("builderWorkspace",["appData",function(a){return{scope:{initFunc:"=init"},priority:450,compile:function(){return{pre:function(b,c,d){b.appData=a,b.initFunc(b,c,d)}}}}}]).directive("emptyToNull",function(){return{restrict:"A",require:"ngModel",link:function(a,b,c,d){d.$parsers.push(function(a){return""===a?null:a})}}}),b.module("ngFastPanoApp.filters",[]).filter("fileSize",function(){var a=["Byte","kB","MB","GB","TB","PB","EB","ZB","YB"];return function(b){if(0==b)return b+" Byte";var c=Math.floor(Math.log(b)/Math.log(1024));return 1*(b/Math.pow(1024,c)).toFixed(0)+" "+a[c]}})}(window,angular,jQuery);